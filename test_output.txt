
[1m[46m RUN [49m[22m [36mv4.0.16 [39m[90m/home/ghost/VS_code_Projects/Auraa-AI[39m

Error: Uncaught [Error: useAuth must be used within an AuthProvider]
    at reportException (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: useAuth must be used within an AuthProvider
    at Module.useAuth (/home/ghost/VS_code_Projects/Auraa-AI/src/hooks/useAuth.tsx:28:11)
    at /home/ghost/VS_code_Projects/Auraa-AI/src/hooks/useAuth.test.tsx:47:24
    at TestComponent (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/@testing-library/react/dist/pure.js:309:27)
    at renderWithHooks (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
Error: Uncaught [Error: useAuth must be used within an AuthProvider]
    at reportException (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: useAuth must be used within an AuthProvider
    at Module.useAuth (/home/ghost/VS_code_Projects/Auraa-AI/src/hooks/useAuth.tsx:28:11)
    at /home/ghost/VS_code_Projects/Auraa-AI/src/hooks/useAuth.test.tsx:47:24
    at TestComponent (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/@testing-library/react/dist/pure.js:309:27)
    at renderWithHooks (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
[90mstderr[2m | src/hooks/useAuth.test.tsx[2m > [22m[2museAuth[2m > [22m[2mthrows error when used outside AuthProvider
[22m[39mThe above error occurred in the <TestComponent> component:

    at TestComponent (/home/ghost/VS_code_Projects/Auraa-AI/node_modules/@testing-library/react/dist/pure.js:307:5)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

 [32mâœ“[39m src/hooks/useAuth.test.tsx [2m([22m[2m4 tests[22m[2m)[22m[32m 166[2mms[22m[39m
 [32mâœ“[39m src/lib/utils.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 25[2mms[22m[39m
 [32mâœ“[39m src/lib/sanitize.test.ts [2m([22m[2m7 tests[22m[2m)[22m[32m 28[2mms[22m[39m

[31mâ¯â¯â¯â¯â¯â¯[39m[1m[41m Failed Suites 1 [49m[22m[31mâ¯â¯â¯â¯â¯â¯â¯[39m

[41m[1m FAIL [22m[49m src/hooks/useAgentMetrics.test.tsx[2m [ src/hooks/useAgentMetrics.test.tsx ][22m
[31m[1mError[22m: [vitest] There was an error when mocking a module. If you are using "vi.mock" factory, make sure there are no top level variables inside, since this call is hoisted to top of the file. Read more: https://vitest.dev/api/vi.html#vi-mock[39m
[36m [2mâ¯[22m src/hooks/useAgentMetrics.tsx:[2m2:1[22m[39m
    [90m  1| [39m[35mimport[39m { useState[33m,[39m useEffect[33m,[39m useCallback } [35mfrom[39m [32m'react'[39m[33m;[39m
    [90m  2| [39m[35mimport[39m { supabase } [35mfrom[39m [32m'@/supabase'[39m[33m;[39m
    [90m   | [39m[31m^[39m
    [90m  3| [39m[35mimport[39m { useAuth } [35mfrom[39m [32m'./useAuth'[39m[33m;[39m
    [90m  4| [39m

[31m[1mCaused by: ReferenceError[22m: Cannot access 'mockSupabase' before initialization[39m
[36m [2mâ¯[22m src/hooks/useAgentMetrics.test.tsx:[2m18:13[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/1]â¯[22m[39m


[2m Test Files [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m3 passed[39m[22m[90m (4)[39m
[2m      Tests [22m [1m[32m12 passed[39m[22m[90m (12)[39m
[2m   Start at [22m 22:41:35
[2m   Duration [22m 12.43s[2m (transform 697ms, setup 862ms, import 808ms, tests 219ms, environment 6.17s)[22m

